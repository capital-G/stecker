<!DOCTYPE html>

<head>
    <title>Stecker debug</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="//unpkg.com/alpinejs"></script>
    <script src="stecker.js"></script>
    <link rel="stylesheet" href="style.css" />
</head>

<body>
    <div class="content container" x-data>
        <h2>Rooms</h2>
        <div class="columns">
            <div class="column">
                <span class="button" @click="$store.stecker.getRooms('CHAT')">Load chat rooms</span>
            </div>
            <div class="column">
                <span class="button" @click="$store.stecker.getRooms('FLOAT')">Load float rooms</span>
            </div>
            <div class="column">
                <span class="button" @click="$store.stecker.getRooms('AUDIO')">Load audio rooms</span>
            </div>
        </div>
        <div class="rooms">
            <table class="table" style="width: 100%;">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>UUID</th>
                        <th># Listeners</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    <template x-for="room in $store.stecker.rooms">
                        <tr>
                            <th x-text="room.name"></th>
                            <th x-text="room.uuid"></th>
                            <th x-text="room.numListeners"></th>
                            <th><button class="button" @click="$store.stecker.joinRoom(`${room.name}`, `${room.roomType}`)" x-bind:disabled="$store.stecker.connected">Join</button></th>
                        </tr>
                    </template>
                </tbody>
            </table>
        </div>


        <div class="form" x-data="{roomName: '', roomType: ''}">
            <div class="field">
                <label class="label">Browser base64 Session Description</label>
                <div class="control">
                    <input class="input" disabled readonly="true" :value="$store.stecker.localSessionDescription"></input>
                </div>
            </div>

            <div class="field">
                <label class="label">Stecker base64 Session Description</label>
                <div class="control">
                    <input class="input" disabled :value="$store.stecker.remoteSessionDescription"></input>
                </div>
            </div>

            <div class="columns">
                <div class="column is-four-fifths">
                    <div class="field">
                        <label class="label">Room name</label>
                        <div class="control">
                            <input class="input" x-model="roomName" x-bind:disabled="$store.stecker.connected"></input>
                        </div>
                    </div>
                </div>
                <div class="column">
                    <div class="field">
                        <label class="label">Room type</label>
                        <div class="control">
                            <div class="select" style="width: 100%;">
                                <select style="width: 100%;" required x-model="roomType" x-bind:disabled="$store.stecker.createdRoom">
                                    <option value="">Select...</option>
                                    <option value="FLOAT">Float</option>
                                    <option value="CHAT">Chat</option>
                                    <option value="AUDIO">Audio</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <button class="button is-link" @click="$store.stecker.createRoom(roomName, roomType)" x-bind:disabled="(roomName.length == 0) || (roomType == '') || $store.stecker.connected">Create room</button><br/>

            <div class="columns">
                <div class="column">
                    <div class="field">
                        <label class="label">Chat message</label>
                        <div class="control">
                            <input class="input" x-model="$store.stecker.chatValue" :disabled="$store.stecker.roomType != 'CHAT'"></input>
                        </div>
                    </div>
                    <button x-bind:disabled="$store.stecker.roomType != 'CHAT'" class="button" @click="$store.stecker.sendChatValue()">Send Message</button> <br />
                </div>
                <div class="column">
                    <div class="field">
                        <label class="label">Float value</label>
                        <div class="control">
                            <input class="input" type="number" step="0.01" x-model="$store.stecker.floatValue" :disabled="!$store.stecker.createdRoom"></input>
                        </div>
                    </div>
                    <button x-bind:disabled="!$store.stecker.createdRoom || $store.stecker.roomType !== 'FLOAT'" class="button" @click="$store.stecker.sendFloatValue()">Send value</button> <br />
                </div>
                <div class="column">
                    <div class="field">
                        <label class="label">Audio</label>
                        <div class="control">
                            <audio controls style="width: 100%;" id="audio-playback"></audio>
                        </div>
                    </div>
                </div>
        </div>


        <h2>Log</h2>
        <div x-data>
            <template x-for="message in $store.stecker.messages">
                <article class="message">
                    <div class="message-body" x-text="message"></div>
                </article>
            </template>
        </div>
    </div>
</body>
</html>
